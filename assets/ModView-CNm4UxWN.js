import{_ as X,c as U,o as E,a as o,r as L,f as de,w as ee,g as W,n as K,d as t,t as H,F as I,h as Y,i as se,j as B,k as n,l as v,e as N,E as Q,m as Z,u as S,p as ve,q as he,s as we,v as Ee,x as G,y as xe,O as Te,z as pe,A as me,B as ie,C as Se,D as Ve,G as Ce,H as Me}from"./index-7aZPKiyI.js";const De="/FkCreator/assets/logo-D8zZ83g_.png",Pe={},Ae={t:"1749178662217",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1491",width:"200",height:"200"};function Ue(P,b){return E(),U("svg",Ae,b[0]||(b[0]=[o("path",{d:"M918.673 883H104.327C82.578 883 65 867.368 65 848.027V276.973C65 257.632 82.578 242 104.327 242h814.346C940.422 242 958 257.632 958 276.973v571.054C958 867.28 940.323 883 918.673 883z",fill:"#FFE9B4","p-id":"1492"},null,-1),o("path",{d:"M512 411H65V210.37C65 188.597 82.598 171 104.371 171h305.92c17.4 0 32.71 11.334 37.681 28.036L512 411z",fill:"#FFB02C","p-id":"1493"},null,-1),o("path",{d:"M918.673 883H104.327C82.578 883 65 865.42 65 843.668V335.332C65 313.58 82.578 296 104.327 296h814.346C940.422 296 958 313.58 958 335.332v508.336C958 865.32 940.323 883 918.673 883z",fill:"#FFCA28","p-id":"1494"},null,-1)]))}const Oe=X(Pe,[["render",Ue]]),Re={},Ne={t:"1749180769353",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"28263",width:"200",height:"200"};function $e(P,b){return E(),U("svg",Ne,b[0]||(b[0]=[o("path",{d:"M802.913524 36.571429c24.81981 0 47.981714 12.239238 61.927619 32.719238l114.395428 167.594666c13.263238 19.504762 20.382476 42.471619 20.382477 66.072381v633.904762c0 41.398857-33.596952 74.99581-74.99581 74.99581H99.376762C57.929143 1011.809524 24.380952 978.16381 24.380952 936.813714V303.104c0-23.552 7.119238-46.567619 20.382477-66.072381l114.346666-167.740952c13.994667-20.48 37.205333-32.719238 61.976381-32.719238h581.827048zM474.502095 351.914667H249.417143a37.546667 37.546667 0 0 0-0.585143 74.995809H474.453333a37.546667 37.546667 0 0 0 0.585143-74.995809h-0.585143z m323.437715-230.936381H226.06019L158.915048 219.428571h706.267428l-67.242666-98.499047z",fill:"#2aa515","p-id":"28264"},null,-1)]))}const Le=X(Re,[["render",$e]]),Be={},Ie={t:"1749180489880",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"12278",width:"200",height:"200"};function He(P,b){return E(),U("svg",Ie,b[0]||(b[0]=[o("path",{d:"M64 192.384C64 121.472 121.408 64 192.384 64h639.232C902.528 64 960 121.408 960 192.384v639.232A128.32 128.32 0 0 1 831.616 960H192.384A128.32 128.32 0 0 1 64 831.616V192.384zM256 256l28.416 28.416 28.48 28.48 28.416 28.416v312.96L256 739.52V768h455.104L768 568.896l-28.416 28.416-28.48 28.48-28.416 28.416H455.04V341.312l28.48-28.416L512 284.416 540.416 256H256z",fill:"#086ECB","p-id":"12279"},null,-1)]))}const Fe=X(Be,[["render",He]]),Xe={},ze={t:"1749180639969",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"15962",width:"200",height:"200"};function je(P,b){return E(),U("svg",ze,b[0]||(b[0]=[o("path",{d:"M512 32C246.912 32 32 246.912 32 512s214.912 480 480 480 480-214.912 480-480S777.088 32 512 32z m-32.976 868.496l-21.984-310.768H214.864L566.976 123.36v310.912l242.16 22.144-330.112 444.08z",fill:"#e98f36","p-id":"15963"},null,-1)]))}const qe=X(Xe,[["render",je]]),We={class:"tree"},Ge={key:0},Ye={class:"tree-icon"},Ze={class:"tree-label"},Je={key:0,class:"subtree"},Ke=["onClick"],Qe={class:"tree-icon"},et={class:"tree-label"},tt={key:0,class:"subtree"},at=["onClick"],lt={class:"tree-icon"},nt={class:"tree-label"},st=["onClick"],ot={class:"tree-icon"},rt={class:"tree-label"},it={__name:"ModTree",props:{mod:{type:Object,required:!0}},emits:["select"],setup(P,{emit:b}){const M=P,s=b,i=L(null),c=(e,a)=>{i.value=a.id,s("select",{type:e,item:a})},p=de();return ee(()=>{const e=p.currentNode;e&&(i.value=e.value.id)}),(e,a)=>(E(),U(I,null,[a[1]||(a[1]=o("div",{class:"tree-title"},"拓展包结构树",-1)),o("ul",We,[M.mod?(E(),U("li",Ge,[o("div",{class:K(["tree-node",{selected:i.value===M.mod.id}]),onClick:a[0]||(a[0]=r=>c("mod",M.mod))},[o("span",Ye,[t(Oe)]),o("span",Ze,H(M.mod.name),1)],2),P.mod.packages.length?(E(),U("ul",Je,[(E(!0),U(I,null,Y(P.mod.packages,r=>(E(),U("li",{key:r.id},[o("div",{class:K(["tree-node",{selected:i.value===r.id}]),onClick:u=>c("package",r)},[o("span",Qe,[t(Le)]),o("span",et,H(r.name),1)],10,Ke),r.generals.length||r.skills.length?(E(),U("ul",tt,[(E(!0),U(I,null,Y(r.generals,u=>(E(),U("li",{key:u.id},[o("div",{class:K(["tree-node",{selected:i.value===u.id}]),onClick:d=>c("general",u)},[o("span",lt,[t(Fe)]),o("span",nt,H(u.name),1)],10,at)]))),128)),(E(!0),U(I,null,Y(r.skills,u=>(E(),U("li",{key:u.id},[o("div",{class:K(["tree-node",{selected:i.value===u.id}]),onClick:d=>c("skill",u)},[o("span",ot,[t(qe)]),o("span",rt,H(u.name),1)],10,st)]))),128))])):W("",!0)]))),128))])):W("",!0)])):W("",!0)])],64))}},dt={__name:"ModEditor",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(P,{emit:b}){const M=b,s=L(P.modelValue),i=p=>{s.value=p,M("update:modelValue",s.value)};ee(()=>{i(s.value)});const c=se({name:[{required:!0,message:"Mod名称不能为空",trigger:"change"}],internal_name:[{required:!0,message:"内部名称不能为空",trigger:"change"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"仅允许英文开头，且仅包含英文字母、数字、下划线",trigger:"change"}],version:[{required:!0,message:"版本不能为空",trigger:"change"}]});return(p,e)=>{const a=v("el-input"),r=v("el-form-item"),u=v("el-col"),d=v("el-row"),V=v("el-form");return E(),B(V,{"label-width":"80px",model:s.value,rules:c},{default:n(()=>[t(d,{gutter:10},{default:n(()=>[t(u,{span:12},{default:n(()=>[t(r,{prop:"name"},{label:n(()=>e[5]||(e[5]=[o("span",null,"Mod名称",-1),o("span",{class:"remark"},"（长度限制20）",-1)])),default:n(()=>[t(a,{modelValue:s.value.name,"onUpdate:modelValue":e[0]||(e[0]=m=>s.value.name=m),placeholder:"请输入Mod名称",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),t(u,{span:12},{default:n(()=>[t(r,{prop:"internal_name"},{label:n(()=>e[6]||(e[6]=[o("span",null,"内部名称（code）",-1),o("span",{class:"remark"},"（长度限制60）",-1)])),default:n(()=>[t(a,{modelValue:s.value.internal_name,"onUpdate:modelValue":e[1]||(e[1]=m=>s.value.internal_name=m),placeholder:"请输入内部名称",maxlength:"60"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(r,{label:"作者",prop:"author"},{label:n(()=>e[7]||(e[7]=[o("span",null,"作者",-1),o("span",{class:"remark"},"（长度限制20）",-1)])),default:n(()=>[t(a,{modelValue:s.value.author,"onUpdate:modelValue":e[2]||(e[2]=m=>s.value.author=m),placeholder:"请输入作者",maxlength:"20"},null,8,["modelValue"])]),_:1}),t(r,{label:"版本",prop:"version"},{default:n(()=>[t(a,{modelValue:s.value.version,"onUpdate:modelValue":e[3]||(e[3]=m=>s.value.version=m),placeholder:"请输入版本号",maxlength:"20"},null,8,["modelValue"])]),_:1}),t(r,{label:"描述",prop:"description"},{default:n(()=>[t(a,{type:"textarea",rows:4,modelValue:s.value.description,"onUpdate:modelValue":e[4]||(e[4]=m=>s.value.description=m),placeholder:"这是一个刚创建的mod，请添加相关信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])}}},pt=X(dt,[["__scopeId","data-v-2b8bfefa"]]),mt={__name:"PackageEditor",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(P,{emit:b}){const M=b,s=L(P.modelValue),i=p=>{s.value=p,M("update:modelValue",s.value)};ee(()=>{i(s.value)});const c=se({name:[{required:!0,message:"包名称不能为空",trigger:"change"}],internal_name:[{required:!0,message:"内部名称不能为空",trigger:"change"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"仅允许英文开头，且仅包含英文字母、数字、下划线",trigger:"change"}]});return(p,e)=>{const a=v("el-input"),r=v("el-form-item"),u=v("el-col"),d=v("el-row"),V=v("el-form");return E(),B(V,{"label-width":"80px",model:s.value,rules:c},{default:n(()=>[t(d,{gutter:10},{default:n(()=>[t(u,{span:12},{default:n(()=>[t(r,{prop:"name"},{label:n(()=>e[3]||(e[3]=[o("span",null,"包名称",-1),o("span",{class:"remark"},"（长度限制20）",-1)])),default:n(()=>[t(a,{modelValue:s.value.name,"onUpdate:modelValue":e[0]||(e[0]=m=>s.value.name=m),placeholder:"请输入Mod名称",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),t(u,{span:12},{default:n(()=>[t(r,{prop:"internal_name"},{label:n(()=>e[4]||(e[4]=[o("span",null,"内部名称（code）",-1),o("span",{class:"remark"},"（长度限制60）",-1)])),default:n(()=>[t(a,{modelValue:s.value.internal_name,"onUpdate:modelValue":e[1]||(e[1]=m=>s.value.internal_name=m),placeholder:"请输入内部名称",maxlength:"60"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(r,{label:"描述",prop:"description"},{default:n(()=>[t(a,{type:"textarea",rows:4,modelValue:s.value.description,"onUpdate:modelValue":e[2]||(e[2]=m=>s.value.description=m),placeholder:"这是一个刚创建的包，请添加相关信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])}}},ut=X(mt,[["__scopeId","data-v-3e97f539"]]),ct={class:"skill-list"},yt=["innerHTML"],ft={__name:"GeneralEditor",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(P,{emit:b}){const M=de(),s=b,i=L(P.modelValue),c=m=>{i.value=m,s("update:modelValue",i.value)};ee(()=>{c(i.value)});const e=se({name:[{required:!0,message:"武将姓名不能为空",trigger:"change"}],internal_name:[{required:!0,message:"内部名称不能为空",trigger:"change"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"仅允许英文开头，且仅包含英文字母、数字、下划线",trigger:"change"}],gender:[{required:!0,message:"性别不能为空",trigger:"change"}],hp:[{validator:(m,l,k)=>{if(l>i.value.maxHp){k(new Error("初始体力不能大于体力上限"));return}k()},trigger:"change"}]}),a=L(""),r=(m,l)=>{const k=[];if(!m){l(k);return}const f=M.currentMod;for(let D=0;D<f.packages.length;D++){const y=f.packages[D].skills;if(y)for(let O=0;O<y.length;O++){const $=y[O];($.name.includes(m)||$.internal_name.includes(m))&&k.push($)}}l(k)},u=m=>{if(i.value.skills||(i.value.skills=[]),i.value.skills.some(l=>l===m.internal_name)){Q.warning("技能已存在");return}i.value.skills.push(m.internal_name)},d=m=>{const l=M.currentMod;for(let k=0;k<l.packages.length;k++){const f=l.packages[k],D=f.skills.find(h=>h.internal_name===m);if(D)return`${D.internal_name}<span class="info">（${f.name}-${D.name}）</span>`}return`${m}<span class="info">（非本扩展技能）</span>`},V=m=>{!m||!m.trim()||Z.confirm(`是否添加自定义技能 "${m}"？`,"添加自定义技能",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{if(i.value.skills||(i.value.skills=[]),i.value.skills.includes(m)){Q.warning("技能已存在");return}i.value.skills.push(m)}).catch(()=>{})};return(m,l)=>{const k=v("el-input"),f=v("el-form-item"),D=v("el-col"),h=v("el-row"),y=v("el-option"),O=v("el-select"),$=v("el-input-number"),z=v("el-switch"),j=v("el-button"),q=v("el-icon"),R=v("el-autocomplete"),J=v("el-tag"),oe=v("el-form");return E(),B(oe,{model:i.value,"label-width":"80px",rules:e},{default:n(()=>[t(h,{gutter:10},{default:n(()=>[t(D,{span:12},{default:n(()=>[t(f,{prop:"name"},{label:n(()=>l[11]||(l[11]=[o("span",null,"武将姓名",-1),o("span",{class:"remark"},"（长度限制20）",-1)])),default:n(()=>[t(k,{modelValue:i.value.name,"onUpdate:modelValue":l[0]||(l[0]=A=>i.value.name=A),placeholder:"请输入武将名称",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),t(D,{span:12},{default:n(()=>[t(f,{prop:"internal_name"},{label:n(()=>l[12]||(l[12]=[o("span",null,"内部名称（code）",-1),o("span",{class:"remark"},"（长度限制60）",-1)])),default:n(()=>[t(k,{modelValue:i.value.internal_name,"onUpdate:modelValue":l[1]||(l[1]=A=>i.value.internal_name=A),placeholder:"请输入内部名称",maxlength:"60"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(h,{gutter:10},{default:n(()=>[t(D,{span:12},{default:n(()=>[t(f,{label:"性别",prop:"gender"},{default:n(()=>[t(O,{modelValue:i.value.gender,"onUpdate:modelValue":l[2]||(l[2]=A=>i.value.gender=A)},{default:n(()=>[t(y,{value:"General.Male",label:"男"}),t(y,{value:"General.Female",label:"女"}),t(y,{value:"General.Agender",label:"无性别"}),t(y,{value:"General.Bigender",label:"双性别（用于男女同框）"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(D,{span:12},{default:n(()=>[t(f,{label:"势力",prop:"kingdom"},{default:n(()=>[t(O,{modelValue:i.value.kingdom,"onUpdate:modelValue":l[3]||(l[3]=A=>i.value.kingdom=A)},{default:n(()=>[t(y,{value:"wei",label:"魏"}),t(y,{value:"shu",label:"蜀"}),t(y,{value:"wu",label:"吴"}),t(y,{value:"qun",label:"群"}),t(y,{value:"jin",label:"晋"}),t(y,{value:"god",label:"神"}),t(y,{value:"evil",label:"魔"}),t(y,{value:"qin",label:"秦"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(h,null,{default:n(()=>[t(f,{label:"初始体力",class:"number-input",prop:"hp"},{default:n(()=>[t($,{modelValue:i.value.hp,"onUpdate:modelValue":l[4]||(l[4]=A=>i.value.hp=A),min:1,max:1e3,onChange:l[5]||(l[5]=A=>i.value.maxHp=Math.max(i.value.maxHp,i.value.hp))},null,8,["modelValue"])]),_:1}),t(f,{label:"体力上限",class:"number-input",prop:"maxHp"},{default:n(()=>[t($,{modelValue:i.value.maxHp,"onUpdate:modelValue":l[6]||(l[6]=A=>i.value.maxHp=A),min:i.value.hp,max:1e3},null,8,["modelValue","min"])]),_:1}),t(f,{label:"初始护甲",class:"number-input",prop:"shield"},{default:n(()=>[t($,{modelValue:i.value.shield,"onUpdate:modelValue":l[7]||(l[7]=A=>i.value.shield=A),min:0,max:5},null,8,["modelValue"])]),_:1}),t(f,{label:" ",class:"number-input",style:{width:"40%"},prop:"hidden"},{default:n(()=>[t(z,{modelValue:i.value.hidden,"onUpdate:modelValue":l[8]||(l[8]=A=>i.value.hidden=A),class:"mb-2",style:{"--el-switch-on-color":"#ff4949","--el-switch-off-color":"#13ce66"},"active-text":"隐藏武将（只能通过自由选将选择）","inactive-text":"正常武将",prop:"hidden"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{label:"绑定技能"},{default:n(()=>[t(R,{modelValue:a.value,"onUpdate:modelValue":l[10]||(l[10]=A=>a.value=A),"fetch-suggestions":r,placeholder:"请输入技能名称 或 技能内部名称",onSelect:u},{append:n(()=>[t(j,{onClick:l[9]||(l[9]=A=>V(a.value))},{default:n(()=>l[13]||(l[13]=[o("span",null,[N("直接添加"),o("span",{class:"info"},"（非本扩展包技能）")],-1)])),_:1,__:[13]})]),loading:n(()=>[t(q,{class:"is-loading"},{default:n(()=>l[14]||(l[14]=[o("svg",{class:"circular",viewBox:"0 0 20 20"},[o("g",{class:"path2 loading-path","stroke-width":"0",style:{animation:"none",stroke:"none"}},[o("circle",{r:"3.375",class:"dot1",rx:"0",ry:"0"}),o("circle",{r:"3.375",class:"dot2",rx:"0",ry:"0"}),o("circle",{r:"3.375",class:"dot4",rx:"0",ry:"0"}),o("circle",{r:"3.375",class:"dot3",rx:"0",ry:"0"})])],-1)])),_:1,__:[14]})]),default:n(({item:A})=>[o("span",null,H(A.name)+" ("+H(A.internal_name)+")",1)]),_:1},8,["modelValue"]),l[15]||(l[15]=o("div",{class:"tips"},"（如需添加本扩展包技能，请在下拉搜索结果中点击；否则请点击“直接添加”）",-1)),o("div",ct,[(E(!0),U(I,null,Y(i.value.skills,A=>(E(),B(J,{key:A,size:"large",type:"success",closable:"",onClose:te=>i.value.skills.splice(i.value.skills.indexOf(A),1)},{default:n(()=>[o("span",{innerHTML:d(A)},null,8,yt)]),_:2},1032,["onClose"]))),128))])]),_:1,__:[15]})]),_:1},8,["model","rules"])}}},gt=X(ft,[["__scopeId","data-v-89ab41fe"]]),ce=[{id:"distance",name:"距离类",description:"用于影响角色之间计算距离",template:{methods:[{name:"correct_func",description:"修改从from到to的距离计算值，返回一个数，正数表示增加距离计算，负数反之",type:"client",params:[{name:"self",message:"本技能",type:"TargetModSkill"},{name:"from",message:"来源角色",type:"Player"},{name:"to",message:"目标角色",type:"Player"}],ret:"number",blockData:null},{name:"fixed_func",description:"将from到to的距离设为固定值，返回的数值即为新距离",type:"client",params:[{name:"self",message:"本技能",type:"TargetModSkill"},{name:"from",message:"来源角色",type:"Player"},{name:"to",message:"目标角色",type:"Player"}],ret:"number",blockData:null}]}},{id:"prohibit",name:"禁止类",description:"用于禁止某角色成为某卡牌目标、禁止使用打出弃置拼点",template:{methods:[{name:"is_prohibited",description:"令from不能使用card指定to为目标",type:"client",params:[{name:"self",message:"本技能",type:"ProhibitSkill"},{name:"from",message:"来源角色",type:"Player"},{name:"to",message:"目标角色",type:"Player"},{name:"card",message:"相关卡牌",type:"Card"}],ret:"bool",blockData:null},{name:"prohibit_use",description:"令player不能使用card",type:"client",params:[{name:"self",message:"本技能",type:"ProhibitSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"card",message:"相关卡牌",type:"Card"}],ret:"bool",blockData:null},{name:"prohibit_response",description:"令player不能打出card",type:"client",params:[{name:"self",message:"本技能",type:"ProhibitSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"card",message:"相关卡牌",type:"Card"}],ret:"bool",blockData:null},{name:"prohibit_discard",description:"令player不能弃置card",type:"client",params:[{name:"self",message:"本技能",type:"ProhibitSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"card",message:"相关卡牌",type:"Card"}],ret:"bool",blockData:null},{name:"prohibit_pindian",description:"令from不能对to拼点",type:"client",params:[{name:"self",message:"本技能",type:"ProhibitSkill"},{name:"from",message:"来源角色",type:"Player"},{name:"to",message:"目标角色",type:"Player"}],ret:"bool",blockData:null}]}},{id:"atkrange",name:"攻击范围类",description:"用于影响某角色的攻击范围计算",template:{methods:[{name:"correct_func",description:"修改from的攻击范围，返回一个数，正数表示增加攻击范围，负数反之",type:"client",params:[{name:"self",message:"本技能",type:"AttackRangeSkill"},{name:"from",message:"来源角色",type:"Player"},{name:"to",message:"目标角色",type:"Player"}],ret:"number",blockData:null},{name:"fixed_func",description:"将from的攻击范围设为固定值，返回的数值即为新攻击范围",type:"client",params:[{name:"self",message:"本技能",type:"AttackRangeSkill"},{name:"player",message:"相关角色",type:"Player"}],ret:"number",blockData:null},{name:"final_func",description:"判定角色的锁定攻击范围终值",type:"client",params:[{name:"self",message:"本技能",type:"AttackRangeSkill"},{name:"player",message:"相关角色",type:"Player"}],ret:"number",blockData:null},{name:"within_func",description:"判定to角色是否锁定在角色from攻击范围内",type:"client",params:[{name:"self",message:"本技能",type:"AttackRangeSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"to",message:"目标角色",type:"Player"}],ret:"any",blockData:null},{name:"without_func",description:"判定to角色是否锁定在角色from攻击范围外",type:"client",params:[{name:"self",message:"本技能",type:"AttackRangeSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"to",message:"目标角色",type:"Player"}],ret:"any",blockData:null}]}},{id:"maxcards",name:"手牌上限类",description:"用于影响某角色的手牌上限计算",template:{methods:[{name:"correct_func",description:"修正角色的手牌上限",type:"client",params:[{name:"self",message:"本技能",type:"MaxCardsSkill"},{name:"player",message:"相关角色",type:"Player"}],ret:"number",blockData:null},{name:"fixed_func",description:"角色的手牌上限固定值",type:"client",params:[{name:"self",message:"本技能",type:"MaxCardsSkill"},{name:"player",message:"相关角色",type:"Player"}],ret:"number",blockData:null},{name:"exclude_from",description:"判定某牌是否不计入手牌上限",type:"client",params:[{name:"self",message:"本技能",type:"MaxCardsSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"card",message:"相关卡牌",type:"Card"}],ret:"any",blockData:null}]}},{id:"targetmod",name:"卡牌增强类",description:"用于增强卡牌（无视距离次数限制等）",template:{methods:[{name:"bypass_times",description:"角色使用牌是否无次数限制",type:"client",params:[{name:"self",message:"本技能",type:"TargetModSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"skill",message:"技能",type:"ActiveSkill"},{name:"scope",message:"作用范围",type:"integer"},{name:"card",message:"相关卡牌",type:"Card"},{name:"to",message:"目标角色",type:"Player"}],ret:"any",blockData:null},{name:"residue_func",description:"角色使用牌的剩余次数",type:"client",params:[{name:"self",message:"本技能",type:"TargetModSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"skill",message:"技能",type:"ActiveSkill"},{name:"scope",message:"作用范围",type:"integer"},{name:"card",message:"相关卡牌",type:"Card"},{name:"to",message:"目标角色",type:"Player"}],ret:"number",blockData:null},{name:"fix_times_func",description:"角色使用牌的固定次数",type:"client",params:[{name:"self",message:"本技能",type:"TargetModSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"skill",message:"技能",type:"ActiveSkill"},{name:"scope",message:"作用范围",type:"integer"},{name:"card",message:"相关卡牌",type:"Card"},{name:"to",message:"目标角色",type:"Player"}],ret:"number",blockData:null},{name:"bypass_distances",description:"角色使用牌是否无距离限制",type:"client",params:[{name:"self",message:"本技能",type:"TargetModSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"skill",message:"技能",type:"ActiveSkill"},{name:"card",message:"相关卡牌",type:"Card"},{name:"to",message:"目标角色",type:"Player"}],ret:"any",blockData:null},{name:"distance_limit_func",description:"角色使用牌的距离限制",type:"client",params:[{name:"self",message:"本技能",type:"TargetModSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"skill",message:"技能",type:"ActiveSkill"},{name:"card",message:"相关卡牌",type:"Card"},{name:"to",message:"目标角色",type:"Player"}],ret:"number",blockData:null},{name:"extra_target_func",description:"角色使用牌的额外目标数",type:"client",params:[{name:"self",message:"本技能",type:"TargetModSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"skill",message:"技能",type:"ActiveSkill"},{name:"card",message:"相关卡牌",type:"Card"}],ret:"number",blockData:null},{name:"target_tip_func",description:"角色使用牌的目标提示",type:"client",params:[{name:"self",message:"本技能",type:"TargetModSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"to_select",message:"待选择的目标角色",type:"Player"},{name:"selected",message:"已选角色",type:"Player[]"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"},{name:"card",message:"相关卡牌",type:"Card"},{name:"selectable",message:"是否可选",type:"boolean"},{name:"extra_data",message:"额外数据",type:"any"}],ret:"string|TargetTipDataSpec",blockData:null}]}},{id:"filter",name:"视为类",description:"用于将某牌视为另一牌名的牌（红颜、武神等）",template:{methods:[{name:"card_filter",description:"卡牌筛选",type:"client",params:[{name:"self",message:"本技能",type:"FilterSkill"},{name:"card",message:"相关卡牌",type:"Card"},{name:"player",message:"相关角色",type:"Player"}],ret:"any",blockData:null},{name:"view_as",description:"视为某牌",type:"client",params:[{name:"self",message:"本技能",type:"FilterSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"card",message:"相关卡牌",type:"Card"}],ret:"Card?",blockData:null},{name:"equip_skill_filter",description:"装备技能筛选",type:"client",params:[{name:"self",message:"本技能",type:"FilterSkill"},{name:"skill",message:"技能",type:"Skill"},{name:"player",message:"相关角色",type:"Player"}],ret:"string?",blockData:null},{name:"handly_cards",description:"视为拥有可以如手牌般使用或打出的牌",type:"client",params:[{name:"self",message:"本技能",type:"FilterSkill"},{name:"player",message:"相关角色",type:"Player"}],ret:"integer[]?",blockData:null}]}},{id:"invalidity",name:"失效类",description:"用于使某角色技能在某条件下失效",template:{methods:[{name:"invalidity_func",description:"判定角色的技能是否无效",type:"client",params:[{name:"self",message:"本技能",type:"InvaliditySkill"},{name:"from",message:"来源角色",type:"Player"},{name:"skill",message:"技能",type:"Skill"}],ret:"any",blockData:null},{name:"invalidity_attackrange",description:"判定武器的攻击范围是否无效",type:"client",params:[{name:"self",message:"本技能",type:"InvaliditySkill"},{name:"player",message:"相关角色",type:"Player"},{name:"card",message:"武器",type:"Weapon"}],ret:"any",blockData:null}]}},{id:"visibility",name:"可见类",description:"用于控制客户端是否应该可以观看到某牌（用于明牌）",template:{methods:[{name:"card_visible",description:"判定角色是否可以看到某牌",type:"client",params:[{name:"self",message:"本技能",type:"VisibilitySkill"},{name:"player",message:"相关角色",type:"Player"},{name:"card",message:"相关卡牌",type:"Card"}],ret:"any",blockData:null},{name:"role_visible",description:"判定角色是否可以看到某角色的身份",type:"client",params:[{name:"self",message:"本技能",type:"VisibilitySkill"},{name:"player",message:"相关角色",type:"Player"},{name:"target",message:"目标角色",type:"Player"}],ret:"any",blockData:null}]}},{id:"active",name:"主动类",description:"用于创建主动型技能（制衡、苦肉等）",template:{methods:[{name:"can_use",description:"判断主动技能否可以发动",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player"}],ret:"any",blockData:null},{name:"card_filter",description:"判断卡牌能否选择",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"to_select",message:"选择的卡牌数量",type:"integer"},{name:"selected",message:"已选卡牌",type:"integer[]"}],ret:"any",blockData:null},{name:"target_filter",description:"判定目标能否选择",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player?"},{name:"to_select",message:"待选择的目标角色",type:"Player"},{name:"selected",message:"已选角色",type:"Player[]"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"}],ret:"any",blockData:null},{name:"feasible",description:"判断卡牌和目标是否符合技能限制",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"selected",message:"已选角色",type:"Player[]"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"},{name:"card",message:"相关卡牌",type:"Card"}],ret:"any",blockData:null},{name:"on_use",description:"使用技能时的效果",type:"server",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"room",message:"所在房间",type:"Room"},{name:"skillUseEvent",message:"技能使用事件",type:"SkillUseData"}],ret:"any",blockData:null},{name:"prompt",description:"提示信息",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"},{name:"selected_targets",message:"已选目标",type:"Player[]"}],ret:"string",blockData:null},{name:"interaction",description:"选项框",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player"}],ret:"table?",blockData:null},{name:"target_tip",description:"目标提示",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"to_select",message:"待选择的目标角色",type:"Player"},{name:"selected",message:"已选角色",type:"Player[]"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"},{name:"card",message:"相关卡牌",type:"Card?"},{name:"selectable",message:"是否可选",type:"boolean"},{name:"extra_data",message:"额外数据",type:"any"}],ret:"string|TargetTipDataSpec?",blockData:null}]}},{id:"cardskill",name:"卡牌类",description:"与主动类类似，但是针对卡牌进行特化（卡牌的效果就是通过主动技实现的）",template:{methods:[{name:"mod_target_filter",description:"判定目标是否合法（例如不能杀自己，火攻无手牌目标）",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"to_select",message:"待选择的目标角色",type:"Player"},{name:"selected",message:"已选角色",type:"Player[]"},{name:"card",message:"相关卡牌",type:"Card"},{name:"extra_data",message:"额外数据",type:"any"}],ret:"any",blockData:null},{name:"target_filter",description:"判定目标能否选择",type:"client",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"player",message:"相关角色",type:"Player?"},{name:"to_select",message:"待选择的目标角色",type:"Player"},{name:"selected",message:"已选角色",type:"Player[]"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"},{name:"card",message:"相关卡牌",type:"Card?"},{name:"extra_data",message:"额外数据",type:"any"}],ret:"any",blockData:null},{name:"feasible",description:"判断卡牌和目标是否符合技能限制",type:"client",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"selected",message:"已选角色",type:"Player[]"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"}],ret:"any",blockData:null},{name:"can_use",description:"判断主动技能否发动",type:"client",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"card",message:"相关卡牌",type:"Card"},{name:"extra_data",message:"额外数据",type:"any"}],ret:"any",blockData:null},{name:"on_use",description:"使用技能时的效果",type:"server",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"room",message:"所在房间",type:"Room"},{name:"cardUseEvent",message:"卡牌使用事件",type:"UseCardData"}],ret:"any",blockData:null},{name:"fix_targets",description:"设置固定目标",type:"client",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"card",message:"相关卡牌",type:"Card"},{name:"extra_data",message:"额外数据",type:"any"}],ret:"Player[]?",blockData:null},{name:"on_action",description:"卡牌额外效果（卡牌效果执行前或执行后生效）",type:"server",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"room",message:"所在房间",type:"Room"},{name:"cardUseEvent",message:"卡牌使用事件",type:"UseCardData"},{name:"finished",message:"卡牌效果是否已执行",type:"boolean"}],ret:"any",blockData:null},{name:"about_to_effect",description:"生效前判断，返回true则取消效果",type:"server",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"room",message:"所在房间",type:"Room"},{name:"effect",message:"效果数据",type:"CardEffectData"}],ret:"boolean?",blockData:null},{name:"on_effect",description:"卡牌效果",type:"server",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"room",message:"所在房间",type:"Room"},{name:"effect",message:"效果数据",type:"CardEffectData"}],ret:"any",blockData:null},{name:"on_nullified",description:"(仅用于延时锦囊)被抵消时执行内容",type:"server",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"room",message:"所在房间",type:"Room"},{name:"effect",message:"效果数据",type:"CardEffectData"}],ret:"any",blockData:null},{name:"offset_func",description:"卡牌生效前，询问抵消（默认杀询问闪，锦囊询问无懈）",type:"server",params:[{name:"self",message:"本技能",type:"CardSkill"},{name:"room",message:"所在房间",type:"Room"},{name:"effect",message:"效果数据",type:"CardEffectData"}],ret:"any",blockData:null},{name:"prompt",description:"提示信息",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"},{name:"selected_targets",message:"已选目标",type:"Player[]"},{name:"extra_data",message:"额外数据",type:"any"}],ret:"string",blockData:null},{name:"target_tip",description:"目标提示",type:"client",params:[{name:"self",message:"本技能",type:"ActiveSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"to_select",message:"待选择的目标角色",type:"Player"},{name:"selected",message:"已选角色",type:"Player[]"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"},{name:"card",message:"相关卡牌",type:"Card?"},{name:"selectable",message:"是否可选",type:"boolean"},{name:"extra_data",message:"额外数据",type:"any"}],ret:"string|TargetTipDataSpec?",blockData:null}]}},{id:"viewas",name:"转化类",description:"用于将一张牌当另一张牌使用打出（武圣、倾国等）",template:{methods:[{name:"card_filter",description:"判断卡牌能否选择",type:"client",params:[{name:"self",message:"本技能",type:"ViewAsSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"to_select",message:"待选择的卡牌",type:"integer"},{name:"selected",message:"已选卡牌",type:"integer[]"}],ret:"any",blockData:null},{name:"view_as",description:"判断转化成什么牌",type:"client",params:[{name:"self",message:"本技能",type:"ViewAsSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"cards",message:"待转化的卡牌",type:"integer[]"}],ret:"Card?",blockData:null},{name:"enabled_at_play",description:"判断是否可以使用",type:"client",params:[{name:"self",message:"本技能",type:"ViewAsSkill"},{name:"player",message:"相关角色",type:"Player"}],ret:"any",blockData:null},{name:"enabled_at_response",description:"判断是否可以可以响应",type:"client",params:[{name:"self",message:"本技能",type:"ViewAsSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"response",message:"是否响应",type:"boolean"}],ret:"any",blockData:null},{name:"before_use",description:"使用/打出前执行的内容，返回字符串则取消此次使用，返回技能名则在本次询问中禁止使用此技能",type:"client",params:[{name:"self",message:"本技能",type:"ViewAsSkill"},{name:"player",message:"相关角色",type:"ServerPlayer"},{name:"use",message:"卡牌使用数据",type:"UseCardDataSpec"}],ret:"string?",blockData:null},{name:"after_use",description:"使用/打出此牌后执行的内容",type:"client",params:[{name:"self",message:"本技能",type:"ViewAsSkill"},{name:"player",message:"相关角色",type:"ServerPlayer"},{name:"use",message:"卡牌使用数据",type:"UseCardData | RespondCardData"}],ret:"string?",blockData:null},{name:"prompt",description:"使用时的提示信息",type:"client",params:[{name:"self",message:"本技能",type:"ViewAsSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"selected_cards",message:"已选卡牌",type:"integer[]"},{name:"selected",message:"已选角色",type:"Player[]"}],ret:"string",blockData:null},{name:"interaction",description:"选项框",type:"client",params:[{name:"self",message:"本技能",type:"ViewAsSkill"},{name:"player",message:"相关角色",type:"Player"}],ret:"table?",blockData:null},{name:"enabled_at_nullification",description:"判断一张牌是否能被此技能转化无懈来响应",type:"client",params:[{name:"self",message:"本技能",type:"ViewAsSkill"},{name:"player",message:"相关角色",type:"Player"},{name:"data",message:"效果数据",type:"CardEffectData"}],ret:"boolean?",blockData:null}]}},{id:"trigger",name:"触发类",description:"在某时机触发，须指定唯一时机",template:{methods:[]}}],_t=P=>{const b=ce.find(M=>M.id===P);if(!b)throw new Error(`Unknown effect type: ${P}`);return b.template},kt=[{value:"hp",label:"体力相关",children:[{value:"hp_change",label:"体力变化时"},{value:"hp_lose",label:"失去体力时"},{value:"hp_recovery",label:"回复体力时"}]},{value:"use_card",label:"使用牌相关",children:[{value:"use_card_when",label:"使用牌时"},{value:"use_card_after",label:"使用牌后"}]}],bt={class:"effect-type-selector"},vt={class:"effect-types-container"},ht={class:"effect-types"},wt=["onClick"],Et={class:"type-info"},xt={key:0,class:"effect-config"},Tt={__name:"AddEffectDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["create","update:modelValue"],setup(P,{emit:b}){const M=P,s=L({name:"",timing:"",description:""}),i=b,c=L(null),p=u=>{c.value=u.id,s.value.name=`${u.name}效果_${new Date().getTime().toString().slice(-4)}`,s.value.timing=""},e=()=>{i("update:modelValue",!1),r()},a=()=>{i("create",{type:c.value,...s.value}),e()},r=()=>{s.value.name="",s.value.description="",c.value=null};return(u,d)=>{const V=v("el-input"),m=v("el-form-item"),l=v("el-tree-select"),k=v("el-form"),f=v("el-button"),D=v("el-dialog");return E(),B(D,{"model-value":M.modelValue,onClose:e,title:"添加效果","close-on-click-modal":!1},{footer:n(()=>[t(f,{class:"cancel-btn",onClick:e},{default:n(()=>d[5]||(d[5]=[N("取消")])),_:1,__:[5]}),t(f,{class:"confirm-btn",type:"primary",onClick:a,disabled:!c.value||!s.value.name},{default:n(()=>d[6]||(d[6]=[N(" 确认 ")])),_:1,__:[6]},8,["disabled"])]),default:n(()=>[o("div",bt,[d[3]||(d[3]=o("h4",null,"效果类型",-1)),o("div",vt,[o("div",ht,[(E(!0),U(I,null,Y(S(ce),h=>(E(),U("div",{key:h.id,class:K(["effect-type-card",{selected:c.value===h.id}]),onClick:y=>p(h)},[o("div",Et,[o("h5",null,H(h.name),1),o("p",null,H(h.description),1)])],10,wt))),128))])])]),c.value?(E(),U("div",xt,[d[4]||(d[4]=o("h4",null,"效果配置",-1)),t(k,{model:s.value},{default:n(()=>[t(m,{label:"效果名称",prop:"name"},{default:n(()=>[t(V,{modelValue:s.value.name,"onUpdate:modelValue":d[0]||(d[0]=h=>s.value.name=h),placeholder:"输入效果名称"},null,8,["modelValue"])]),_:1}),c.value==="trigger"?(E(),B(m,{key:0,label:"触发时机",prop:"timing"},{default:n(()=>[t(l,{modelValue:s.value.timing,"onUpdate:modelValue":d[1]||(d[1]=h=>s.value.timing=h),data:S(kt),filterable:"",style:{width:"100%"}},null,8,["modelValue","data"])]),_:1})):W("",!0),t(m,{label:"效果描述",prop:"description"},{default:n(()=>[t(V,{type:"textarea",modelValue:s.value.description,"onUpdate:modelValue":d[2]||(d[2]=h=>s.value.description=h),placeholder:"输入效果描述",rows:4},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])):W("",!0)]),_:1},8,["model-value"])}}},St=X(Tt,[["__scopeId","data-v-dd75d63d"]]),Vt={kind:"category",name:"分支与循环",categorystyle:"logic_category",contents:[{type:"controls_if",kind:"block"},{type:"controls_repeat_ext",kind:"block",inputs:{TIMES:{shadow:{type:"math_number",fields:{NUM:10}}}}},{type:"controls_repeat",kind:"block",enabled:!1,fields:{TIMES:10}},{type:"controls_whileUntil",kind:"block",fields:{MODE:"WHILE"}},{type:"controls_for",kind:"block",fields:{VAR:{name:"i"}},inputs:{FROM:{shadow:{type:"math_number",fields:{NUM:1}}},TO:{shadow:{type:"math_number",fields:{NUM:10}}},BY:{shadow:{type:"math_number",fields:{NUM:1}}}}},{type:"controls_forEach",kind:"block",fields:{VAR:{name:"j"}}},{type:"controls_flow_statements",kind:"block",fields:{FLOW:"BREAK"}}]},Ct={kind:"category",name:"布尔相关",colour:"#EE2488",contents:[{type:"logic_compare",kind:"block",fields:{OP:"EQ"}},{type:"logic_operation",kind:"block",fields:{OP:"AND"}},{type:"logic_negate",kind:"block"},{type:"logic_boolean",kind:"block",fields:{BOOL:"TRUE"}},{type:"logic_null",kind:"block",enabled:!1},{type:"logic_ternary",kind:"block"}]},Mt={kind:"category",name:"数值运算相关",categorystyle:"math_category",contents:[{type:"math_number",kind:"block",fields:{NUM:123}},{type:"math_arithmetic",kind:"block",fields:{OP:"ADD"},inputs:{A:{shadow:{type:"math_number",fields:{NUM:1}}},B:{shadow:{type:"math_number",fields:{NUM:1}}}}},{type:"math_single",kind:"block",fields:{OP:"ROOT"},inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:9}}}}},{type:"math_trig",kind:"block",fields:{OP:"SIN"},inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:45}}}}},{type:"math_constant",kind:"block",fields:{CONSTANT:"PI"}},{type:"math_number_property",kind:"block",fields:{PROPERTY:"EVEN"},inputs:{NUMBER_TO_CHECK:{shadow:{type:"math_number",fields:{NUM:0}}}}},{type:"math_round",kind:"block",fields:{OP:"ROUND"},inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:3.1}}}}},{type:"math_on_list",kind:"block",fields:{OP:"SUM"}},{type:"math_modulo",kind:"block",inputs:{DIVIDEND:{shadow:{type:"math_number",fields:{NUM:64}}},DIVISOR:{shadow:{type:"math_number",fields:{NUM:10}}}}},{type:"math_constrain",kind:"block",inputs:{VALUE:{shadow:{type:"math_number",fields:{NUM:50}}},LOW:{shadow:{type:"math_number",fields:{NUM:1}}},HIGH:{shadow:{type:"math_number",fields:{NUM:100}}}}},{type:"math_random_int",kind:"block",inputs:{FROM:{shadow:{type:"math_number",fields:{NUM:1}}},TO:{shadow:{type:"math_number",fields:{NUM:100}}}}},{type:"math_random_float",kind:"block"},{type:"math_atan2",kind:"block",inputs:{X:{shadow:{type:"math_number",fields:{NUM:1}}},Y:{shadow:{type:"math_number",fields:{NUM:1}}}}}]},Dt={kind:"category",name:"字符串相关",categorystyle:"text_category",contents:[{type:"text",kind:"block",fields:{TEXT:""}},{type:"text_join",kind:"block"},{type:"text_append",kind:"block",fields:{name:"item"},inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"text_length",kind:"block",inputs:{VALUE:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{type:"text_isEmpty",kind:"block",inputs:{VALUE:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"text_indexOf",kind:"block",fields:{END:"FIRST"},inputs:{VALUE:{block:{type:"variables_get",fields:{VAR:{name:"text"}}}},FIND:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{type:"text_charAt",kind:"block",fields:{WHERE:"FROM_START"},inputs:{VALUE:{block:{type:"variables_get",fields:{VAR:{name:"text"}}}}}},{type:"text_getSubstring",kind:"block",fields:{WHERE1:"FROM_START",WHERE2:"FROM_START"},inputs:{STRING:{block:{type:"variables_get",fields:{VAR:{name:"text"}}}}}},{type:"text_changeCase",kind:"block",fields:{CASE:"UPPERCASE"},inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{type:"text_trim",kind:"block",fields:{MODE:"BOTH"},inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{type:"text_count",kind:"block",inputs:{SUB:{shadow:{type:"text",fields:{TEXT:""}}},TEXT:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"text_replace",kind:"block",inputs:{FROM:{shadow:{type:"text",fields:{TEXT:""}}},TO:{shadow:{type:"text",fields:{TEXT:""}}},TEXT:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"text_reverse",kind:"block",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"text_print",kind:"block",inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}}}},{type:"text_prompt_ext",kind:"block",fields:{TYPE:"TEXT"},inputs:{TEXT:{shadow:{type:"text",fields:{TEXT:"abc"}}}}}]},Pt={kind:"category",name:"列表相关",categorystyle:"list_category",contents:[{type:"lists_create_with",kind:"block"},{type:"lists_create_with",kind:"block"},{type:"lists_repeat",kind:"block",inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:5}}}}},{type:"lists_length",kind:"block"},{type:"lists_isEmpty",kind:"block"},{type:"lists_indexOf",kind:"block",fields:{END:"FIRST"},inputs:{VALUE:{block:{type:"variables_get",fields:{VAR:{name:"list"}}}}}},{type:"lists_getIndex",kind:"block",fields:{MODE:"GET",WHERE:"FROM_START"},inputs:{VALUE:{block:{type:"variables_get",fields:{VAR:{name:"list"}}}}}},{type:"lists_setIndex",kind:"block",fields:{MODE:"SET",WHERE:"FROM_START"},inputs:{LIST:{block:{type:"variables_get",fields:{VAR:{name:"list"}}}}}},{type:"lists_getSublist",kind:"block",fields:{WHERE1:"FROM_START",WHERE2:"FROM_START"},inputs:{LIST:{block:{type:"variables_get",fields:{VAR:{name:"list"}}}}}},{type:"lists_split",kind:"block",fields:{MODE:"SPLIT"},inputs:{DELIM:{shadow:{type:"text",fields:{TEXT:","}}}}},{type:"lists_sort",kind:"block",fields:{TYPE:"NUMERIC",DIRECTION:"1"}},{type:"lists_reverse",kind:"block"}]},At={kind:"category",name:"卡牌相关",colour:"#EE2488",contents:[{type:"card_property_read",kind:"block"},{type:"card_property_func",kind:"block"},{type:"card_match_pattern",kind:"block"},{type:"card_get_mark",kind:"block"},{type:"get_card_by_id",kind:"block",inputs:{ID:{shadow:{type:"math_number",fields:{NUM:1}}}}},{type:"clone_card",kind:"block",inputs:{NAME:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"print_card",kind:"block",inputs:{NAME:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"draw_n_cards",kind:"block",inputs:{NUMBER:{shadow:{type:"math_number",fields:{NUM:1}}}}},{type:"card_add_subcards",kind:"block"}]},Ut={kind:"category",name:"角色信息读取",colour:"#EE2488",contents:[{type:"player_property_read",kind:"block"},{type:"player_property_read_by_fn",kind:"block"},{type:"player_get_card_ids",kind:"block"},{type:"player_used_times",kind:"block",inputs:{NAME:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"player_prohibited_card",kind:"block"},{type:"player_has_skill",kind:"block",inputs:{NAME:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"player_has_delay",kind:"block"},{type:"player_get_mark",kind:"block"},{type:"player_get_pile",kind:"block"},{type:"player_distance_to",kind:"block"},{type:"player_in_attack_range",kind:"block"}]},Ot={kind:"category",name:"武将相关",colour:"#EE2488",contents:[{type:"general_property_read",kind:"block"},{type:"general_skill_list",kind:"block",inputs:{LORD:{shadow:{type:"logic_boolean",fields:{BOOL:"TRUE"}}}}},{type:"get_general_by_name",kind:"block",inputs:{NAME:{shadow:{type:"text",fields:{TEXT:""}}}}},{type:"draw_n_generals",kind:"block",inputs:{NUMBER:{shadow:{type:"math_number",fields:{NUM:1}}}}},{type:"return_to_general_pile",kind:"block"}]},Rt={kind:"category",name:"匹配器相关",colour:"#EE2488",contents:[{type:"make_matcher",kind:"block"},{type:"matcher_array",kind:"block"}]},Nt={kind:"category",name:"生成结算-体力值相关",colour:"green",contents:[{type:"deal_damage",kind:"block",inputs:{AMOUNT:{shadow:{type:"math_number",fields:{NUM:1}}}}},{type:"lose_hp",kind:"block",inputs:{AMOUNT:{shadow:{type:"math_number",fields:{NUM:1}}}}},{type:"recover_hp",kind:"block",inputs:{AMOUNT:{shadow:{type:"math_number",fields:{NUM:1}}}}},{type:"change_maxhp",kind:"block",inputs:{AMOUNT:{shadow:{type:"math_number",fields:{NUM:1}}}}}]},$t={kind:"category",name:"生成结算-判定相关",colour:"green",contents:[{type:"judge",kind:"block"},{type:"retrial",kind:"block"}]},Lt={kind:"categoryToolbox",contents:[Vt,Ct,Mt,Dt,Pt,{kind:"sep"},{kind:"category",name:"该方法的变量",custom:"METHOD_PARAMS",categorystyle:"variable_category"},{kind:"category",name:"自定义变量",custom:"VARIABLE_DYNAMIC",categorystyle:"variable_category"},{kind:"category",name:"自定义函数",custom:"PROCEDURE",categorystyle:"procedure_category"},{kind:"sep"},At,Ut,Ot,Rt,{kind:"sep"},Nt,$t]};var ne={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */var Bt=ne.exports,ue;function It(){return ue||(ue=1,function(P,b){(function(s,i){P.exports=i()})(Bt,function(){return function(){var M={686:function(c,p,e){e.d(p,{default:function(){return be}});var a=e(279),r=e.n(a),u=e(370),d=e.n(u),V=e(817),m=e.n(V);function l(T){try{return document.execCommand(T)}catch{return!1}}var k=function(_){var g=m()(_);return l("cut"),g},f=k;function D(T){var _=document.documentElement.getAttribute("dir")==="rtl",g=document.createElement("textarea");g.style.fontSize="12pt",g.style.border="0",g.style.padding="0",g.style.margin="0",g.style.position="absolute",g.style[_?"right":"left"]="-9999px";var w=window.pageYOffset||document.documentElement.scrollTop;return g.style.top="".concat(w,"px"),g.setAttribute("readonly",""),g.value=T,g}var h=function(_,g){var w=D(_);g.container.appendChild(w);var x=m()(w);return l("copy"),w.remove(),x},y=function(_){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},w="";return typeof _=="string"?w=h(_,g):_ instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(_==null?void 0:_.type)?w=h(_.value,g):(w=m()(_),l("copy")),w},O=y;function $(T){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$=function(g){return typeof g}:$=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},$(T)}var z=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=_.action,w=g===void 0?"copy":g,x=_.container,C=_.target,F=_.text;if(w!=="copy"&&w!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(C!==void 0)if(C&&$(C)==="object"&&C.nodeType===1){if(w==="copy"&&C.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(w==="cut"&&(C.hasAttribute("readonly")||C.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(F)return O(F,{container:x});if(C)return w==="cut"?f(C):O(C,{container:x})},j=z;function q(T){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?q=function(g){return typeof g}:q=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},q(T)}function R(T,_){if(!(T instanceof _))throw new TypeError("Cannot call a class as a function")}function J(T,_){for(var g=0;g<_.length;g++){var w=_[g];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(T,w.key,w)}}function oe(T,_,g){return _&&J(T.prototype,_),g&&J(T,g),T}function A(T,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");T.prototype=Object.create(_&&_.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),_&&te(T,_)}function te(T,_){return te=Object.setPrototypeOf||function(w,x){return w.__proto__=x,w},te(T,_)}function ye(T){var _=_e();return function(){var w=ae(T),x;if(_){var C=ae(this).constructor;x=Reflect.construct(w,arguments,C)}else x=w.apply(this,arguments);return fe(this,x)}}function fe(T,_){return _&&(q(_)==="object"||typeof _=="function")?_:ge(T)}function ge(T){if(T===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T}function _e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function ae(T){return ae=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)},ae(T)}function re(T,_){var g="data-clipboard-".concat(T);if(_.hasAttribute(g))return _.getAttribute(g)}var ke=function(T){A(g,T);var _=ye(g);function g(w,x){var C;return R(this,g),C=_.call(this),C.resolveOptions(x),C.listenClick(w),C}return oe(g,[{key:"resolveOptions",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof x.action=="function"?x.action:this.defaultAction,this.target=typeof x.target=="function"?x.target:this.defaultTarget,this.text=typeof x.text=="function"?x.text:this.defaultText,this.container=q(x.container)==="object"?x.container:document.body}},{key:"listenClick",value:function(x){var C=this;this.listener=d()(x,"click",function(F){return C.onClick(F)})}},{key:"onClick",value:function(x){var C=x.delegateTarget||x.currentTarget,F=this.action(C)||"copy",le=j({action:F,container:this.container,target:this.target(C),text:this.text(C)});this.emit(le?"success":"error",{action:F,text:le,trigger:C,clearSelection:function(){C&&C.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(x){return re("action",x)}},{key:"defaultTarget",value:function(x){var C=re("target",x);if(C)return document.querySelector(C)}},{key:"defaultText",value:function(x){return re("text",x)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(x){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return O(x,C)}},{key:"cut",value:function(x){return f(x)}},{key:"isSupported",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],C=typeof x=="string"?[x]:x,F=!!document.queryCommandSupported;return C.forEach(function(le){F=F&&!!document.queryCommandSupported(le)}),F}}]),g}(r()),be=ke},828:function(c){var p=9;if(typeof Element<"u"&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}function a(r,u){for(;r&&r.nodeType!==p;){if(typeof r.matches=="function"&&r.matches(u))return r;r=r.parentNode}}c.exports=a},438:function(c,p,e){var a=e(828);function r(V,m,l,k,f){var D=d.apply(this,arguments);return V.addEventListener(l,D,f),{destroy:function(){V.removeEventListener(l,D,f)}}}function u(V,m,l,k,f){return typeof V.addEventListener=="function"?r.apply(null,arguments):typeof l=="function"?r.bind(null,document).apply(null,arguments):(typeof V=="string"&&(V=document.querySelectorAll(V)),Array.prototype.map.call(V,function(D){return r(D,m,l,k,f)}))}function d(V,m,l,k){return function(f){f.delegateTarget=a(f.target,m),f.delegateTarget&&k.call(V,f)}}c.exports=u},879:function(c,p){p.node=function(e){return e!==void 0&&e instanceof HTMLElement&&e.nodeType===1},p.nodeList=function(e){var a=Object.prototype.toString.call(e);return e!==void 0&&(a==="[object NodeList]"||a==="[object HTMLCollection]")&&"length"in e&&(e.length===0||p.node(e[0]))},p.string=function(e){return typeof e=="string"||e instanceof String},p.fn=function(e){var a=Object.prototype.toString.call(e);return a==="[object Function]"}},370:function(c,p,e){var a=e(879),r=e(438);function u(l,k,f){if(!l&&!k&&!f)throw new Error("Missing required arguments");if(!a.string(k))throw new TypeError("Second argument must be a String");if(!a.fn(f))throw new TypeError("Third argument must be a Function");if(a.node(l))return d(l,k,f);if(a.nodeList(l))return V(l,k,f);if(a.string(l))return m(l,k,f);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function d(l,k,f){return l.addEventListener(k,f),{destroy:function(){l.removeEventListener(k,f)}}}function V(l,k,f){return Array.prototype.forEach.call(l,function(D){D.addEventListener(k,f)}),{destroy:function(){Array.prototype.forEach.call(l,function(D){D.removeEventListener(k,f)})}}}function m(l,k,f){return r(document.body,l,k,f)}c.exports=u},817:function(c){function p(e){var a;if(e.nodeName==="SELECT")e.focus(),a=e.value;else if(e.nodeName==="INPUT"||e.nodeName==="TEXTAREA"){var r=e.hasAttribute("readonly");r||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),r||e.removeAttribute("readonly"),a=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var u=window.getSelection(),d=document.createRange();d.selectNodeContents(e),u.removeAllRanges(),u.addRange(d),a=u.toString()}return a}c.exports=p},279:function(c){function p(){}p.prototype={on:function(e,a,r){var u=this.e||(this.e={});return(u[e]||(u[e]=[])).push({fn:a,ctx:r}),this},once:function(e,a,r){var u=this;function d(){u.off(e,d),a.apply(r,arguments)}return d._=a,this.on(e,d,r)},emit:function(e){var a=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),u=0,d=r.length;for(u;u<d;u++)r[u].fn.apply(r[u].ctx,a);return this},off:function(e,a){var r=this.e||(this.e={}),u=r[e],d=[];if(u&&a)for(var V=0,m=u.length;V<m;V++)u[V].fn!==a&&u[V].fn._!==a&&d.push(u[V]);return d.length?r[e]=d:delete r[e],this}},c.exports=p,c.exports.TinyEmitter=p}},s={};function i(c){if(s[c])return s[c].exports;var p=s[c]={exports:{}};return M[c](p,p.exports,i),p.exports}return function(){i.n=function(c){var p=c&&c.__esModule?function(){return c.default}:function(){return c};return i.d(p,{a:p}),p}}(),function(){i.d=function(c,p){for(var e in p)i.o(p,e)&&!i.o(c,e)&&Object.defineProperty(c,e,{enumerable:!0,get:p[e]})}}(),function(){i.o=function(c,p){return Object.prototype.hasOwnProperty.call(c,p)}}(),i(686)}().default})}(ne)),ne.exports}var Ht=It();const Ft=ve(Ht),Xt=P=>({toClipboard(b,M){return new Promise((s,i)=>{const c=document.createElement("button"),p=new Ft(c,{text:()=>b,action:()=>"copy",container:M!==void 0?M:document.body});p.on("success",e=>{p.destroy(),s(e)}),p.on("error",e=>{p.destroy(),i(e)}),document.body.appendChild(c),c.click(),document.body.removeChild(c)})}}),{toClipboard:zt}=Xt(),jt=(P,b="复制成功！")=>{zt(P).then(()=>{Q.success(b)})},qt={class:"dialog-header"},Wt={class:"dialog-title"},Gt={class:"method-editor-buttons"},Yt={class:"method-editor"},Zt={class:"lua"},Jt={__name:"MethodEditorDialog",props:{modelValue:{type:Boolean,default:!1},data:{type:Object,required:!0}},emits:["update:modelValue","save"],setup(P,{emit:b}){const M=function(h){const y=[];return h.localMethod.params.forEach(O=>{const $="param_get_"+O.name;y.push({kind:"block",type:$})}),y},s=P,i=b,c=()=>{i("update:modelValue",!1);const h=G(e.value);h&&h.dispose()},p=L(),e=L(),a=L();he(()=>{we(()=>{u()})});const r=()=>{Z.confirm("关闭编辑页面会导致未保存数据丢失，是否确认关闭？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{c()})},u=()=>{e.value=Ee(a.value,{media:"https://unpkg.com/blockly@10.0.0/media/",toolbox:Lt,scrollbars:!0,trashcan:!0,collapse:!0,renderer:"thrasos",grid:{spacing:20,length:2,colour:"#ccc"},zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2,pinch:!0}});const h=G(e.value);p.value=JSON.parse(JSON.stringify(s.data)),h.localMethod=p.value,h.registerToolboxCategoryCallback("METHOD_PARAMS",M),p.value.params.forEach(y=>{const O="param_get_"+y.name;xe([{type:O,message0:y.message,output:y.type,colour:112}]),pe.forBlock[O]=()=>[y.name,Te.ATOMIC]}),e.value.addChangeListener(V),p.value.blocksState?me.workspaces.load(p.value.blocksState,h):d()},d=()=>{const y=G(e.value).newBlock("function_start");y.initSvg(),y.render(),y.setDeletable(!1),y.moveBy(30,30)},V=h=>{const y=G(e.value);if(h.type===ie.BLOCK_DELETE){const O=y.getBlockById(h.blockId);O&&O.type==="function_start"&&(ie.disable(),d(),ie.enable())}},m=L(""),l=L(!1),k=async()=>{const h=G(e.value);try{m.value=pe.workspaceToCode(h),l.value=!0}catch(y){Z.alert("预览lua失败: "+y.message,{type:"error"})}},f=()=>{const h=G(e.value);p.value.blocksState=me.workspaces.save(h),i("save",{blocksState:p.value.blocksState})},D=()=>{Z.confirm("清空会导致未保存数据丢失，是否确认清空？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{p.value.blocksJson=null,p.value.isDefault=!0,G(e.value).clear(),d()})};return(h,y)=>{const O=v("el-button"),$=v("el-dialog"),z=Se("highlight");return E(),U(I,null,[t($,{class:"method-editor-dialog","model-value":s.modelValue,title:"方法编辑："+s.data.name,fullscreen:"","close-on-click-modal":!1,"show-close":!1,"append-to-body":""},{header:n(()=>[o("div",qt,[o("div",Wt,"方法编辑："+H(s.data.name),1),o("div",Gt,[t(O,{type:"primary",onClick:k},{default:n(()=>y[3]||(y[3]=[N("预览Lua代码")])),_:1,__:[3]}),t(O,{type:"primary",onClick:f},{default:n(()=>y[4]||(y[4]=[N("保存")])),_:1,__:[4]}),t(O,{type:"warning",plain:"",onClick:D},{default:n(()=>y[5]||(y[5]=[N("清空")])),_:1,__:[5]}),t(O,{type:"danger",onClick:r},{default:n(()=>y[6]||(y[6]=[N("关闭")])),_:1,__:[6]})])])]),default:n(()=>[o("div",Yt,[o("div",{ref_key:"blocklyDiv",ref:a,class:"blockly-container"},null,512)]),y[7]||(y[7]=o("div",{class:"bottom-info"},[o("p",null,"注意：编辑完成后请点击保存按钮以保存修改。"),o("p",null,"@ Powr By Blockly")],-1))]),_:1,__:[7]},8,["model-value","title"]),t($,{modelValue:l.value,"onUpdate:modelValue":y[2]||(y[2]=j=>l.value=j),title:"预览Lua代码","close-on-click-modal":!1,"show-close":!0,width:"80%","append-to-body":""},{footer:n(()=>[t(O,{type:"primary",onClick:y[0]||(y[0]=j=>S(jt)(m.value,"代码复制成功！"))},{default:n(()=>y[8]||(y[8]=[N("复制")])),_:1,__:[8]}),t(O,{type:"danger",onClick:y[1]||(y[1]=j=>l.value=!1)},{default:n(()=>y[9]||(y[9]=[N("关闭")])),_:1,__:[9]})]),default:n(()=>[Ve((E(),U("pre",null,[o("code",Zt,H(m.value),1)])),[[z]])]),_:1},8,["modelValue"])],64)}}},Kt={__name:"EffectMethodsDialog",props:{modelValue:{type:Boolean,default:!1},data:{type:Array,required:!0}},emits:["update:modelValue","delete"],setup(P,{emit:b}){const M=P,s=b,i=()=>{s("update:modelValue",!1)},c=L(!1),p=L(null),e=r=>{p.value=r,c.value=!0},a=({blocksState:r,blocksCode:u})=>{p.value.blocksState=r,p.value.blocksCode=u,s("update:modelValue",!1),Z.alert(`方法【${p.value.name}】已保存`,"保存成功",{type:"success"})};return(r,u)=>{const d=v("el-table-column"),V=v("el-button"),m=v("el-table"),l=v("el-dialog");return E(),U(I,null,[t(l,{class:"dialog","model-value":M.modelValue,onClose:i,title:"效果方法配置","close-on-click-modal":!1},{default:n(()=>[t(m,{data:M.data,class:"table",border:""},{default:n(()=>[t(d,{prop:"name",label:"方法名称","min-width":"100"}),t(d,{prop:"description",label:"方法描述","min-width":"120"}),t(d,{label:"操作","min-width":"80",align:"center"},{default:n(({row:k})=>[t(V,{type:"text",onClick:()=>e(k)},{default:n(()=>u[1]||(u[1]=[N("编辑")])),_:2,__:[1]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["model-value"]),c.value?(E(),B(Jt,{key:0,modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=k=>c.value=k),data:p.value,onSave:a},null,8,["modelValue","data"])):W("",!0)],64)}}},Qt=X(Kt,[["__scopeId","data-v-6681d19b"]]),ea={__name:"SkillEditor",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(P,{emit:b}){const M=b,s=L(P.modelValue),i=m=>{s.value=m,M("update:modelValue",s.value)},c=[{label:"主公技",value:"Skill.Lord"},{label:"锁定技",value:"Skill.Compulsory"}];ee(()=>{i(s.value)});const p=se({name:[{required:!0,message:"技能名称不能为空",trigger:"change"}],internal_name:[{required:!0,message:"内部名称不能为空",trigger:"change"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"仅允许英文开头，且仅包含英文字母、数字、下划线",trigger:"change"}],description:[{required:!0,message:"技能描述不能为空",trigger:"change"}]}),e=L(!1),a=m=>{const l=_t(m.type);if(!l||Object.keys(l).length===0){Q.error("未找到效果模板");return}const k=Ce(m),f={...JSON.parse(JSON.stringify(l)),...k};return s.value.effects.push(f),f},r=(m,l)=>{Z.confirm(`确定删除效果【${l.name}】吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{s.value.effects.splice(m,1),Q.success("删除成功")})},u=L(!1),d=L([]),V=m=>{d.value=m.methods,u.value=!0};return(m,l)=>{const k=v("el-input"),f=v("el-form-item"),D=v("el-col"),h=v("el-row"),y=v("el-option"),O=v("el-select"),$=v("el-button"),z=v("el-table-column"),j=v("el-table"),q=v("el-form");return E(),U(I,null,[t(q,{"label-width":"80px",model:s.value,rules:p},{default:n(()=>[t(h,{gutter:10},{default:n(()=>[t(D,{span:12},{default:n(()=>[t(f,{prop:"name"},{label:n(()=>l[7]||(l[7]=[o("span",null,"技能名称",-1),o("span",{class:"remark"},"（长度限制10）",-1)])),default:n(()=>[t(k,{modelValue:s.value.name,"onUpdate:modelValue":l[0]||(l[0]=R=>s.value.name=R),placeholder:"技能名称",maxlength:"10"},null,8,["modelValue"])]),_:1})]),_:1}),t(D,{span:12},{default:n(()=>[t(f,{prop:"internal_name"},{label:n(()=>l[8]||(l[8]=[o("span",null,"内部名称（code）",-1),o("span",{class:"remark"},"（长度限制60）",-1)])),default:n(()=>[t(k,{modelValue:s.value.internal_name,"onUpdate:modelValue":l[1]||(l[1]=R=>s.value.internal_name=R),placeholder:"请输入内部名称",maxlength:"60"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(f,{label:"技能描述",prop:"description"},{default:n(()=>[t(k,{type:"textarea",rows:4,modelValue:s.value.description,"onUpdate:modelValue":l[2]||(l[2]=R=>s.value.description=R),placeholder:"这是一个刚创建的技能，请添加相关信息"},null,8,["modelValue"])]),_:1}),t(f,{label:"技能标签",prop:"tags"},{default:n(()=>[t(O,{modelValue:s.value.tags,"onUpdate:modelValue":l[3]||(l[3]=R=>s.value.tags=R),multiple:"",placeholder:"请选择技能标签（可多选）",style:{width:"100%"},"tag-type":"warning"},{default:n(()=>[(E(),U(I,null,Y(c,R=>t(y,{key:R.value,label:R.label,value:R.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"技能效果"},{default:n(()=>[t(h,null,{default:n(()=>[t(D,{span:24},{default:n(()=>[t($,{type:"primary",onClick:l[4]||(l[4]=R=>e.value=!0)},{default:n(()=>l[9]||(l[9]=[N("添加效果")])),_:1,__:[9]})]),_:1}),t(D,{span:24},{default:n(()=>[t(j,{data:s.value.effects,border:"",class:"table"},{default:n(()=>[t(z,{prop:"name",label:"效果名","min-width":"100"}),t(z,{prop:"description",label:"描述","min-width":"200"},{default:n(R=>[o("span",null,H(R.row.description||"-"),1)]),_:1}),t(z,{label:"操作","min-width":"80",align:"center"},{default:n(R=>[t($,{type:"text",onClick:()=>V(R.row)},{default:n(()=>l[10]||(l[10]=[N(" 方法配置 ")])),_:2,__:[10]},1032,["onClick"]),t($,{type:"danger",text:"",onClick:J=>r(R.$index,R.row)},{default:n(()=>l[11]||(l[11]=[N(" 删除 ")])),_:2,__:[11]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"]),t(St,{modelValue:e.value,"onUpdate:modelValue":l[5]||(l[5]=R=>e.value=R),onCreate:a},null,8,["modelValue"]),t(Qt,{modelValue:u.value,"onUpdate:modelValue":l[6]||(l[6]=R=>u.value=R),data:d.value},null,8,["modelValue","data"])],64)}}},ta=X(ea,[["__scopeId","data-v-ef94f0a0"]]),aa={class:"container"},la={key:0,class:"welcome-screen"},na={class:"container-tree"},sa={class:"container-content"},oa={class:"content-title"},ra={class:"content-label"},ia={class:"button-group"},da={class:"content"},pa={__name:"ModView",setup(P){const b=de(),{currentMod:M,currentNode:s}=Me(b),i=e=>{b.setCurrentNode({type:e.type,value:e.item})},c=e=>{switch(e){case"mod":return"Mod配置";case"package":return"包配置";case"general":return"武将配置";case"skill":return"技能配置";default:return""}},p=(e,a)=>e+":"+a.id;return window.addEventListener("beforeunload",function(e){!M.value||!s.value||(e.preventDefault(),e.returnValue=!1)}),(e,a)=>{const r=v("el-button"),u=v("el-button-group");return E(),U("div",aa,[S(M)?(E(),U(I,{key:1},[o("div",na,[t(it,{mod:S(M),onSelect:a[2]||(a[2]=d=>i(d))},null,8,["mod"])]),o("div",sa,[o("div",oa,[o("div",ra,H(c(S(s).type)),1),o("div",ia,[S(s).type==="mod"?(E(),U(I,{key:0},[S(s).type==="mod"?(E(),B(r,{key:0,type:"primary",onClick:a[3]||(a[3]=d=>S(b).addPackage())},{default:n(()=>a[19]||(a[19]=[N("添加包 ")])),_:1,__:[19]})):W("",!0)],64)):S(s).type==="package"?(E(),U(I,{key:1},[t(r,{type:"primary",onClick:a[4]||(a[4]=d=>S(b).addGeneral())},{default:n(()=>a[20]||(a[20]=[N("添加武将")])),_:1,__:[20]}),t(r,{type:"primary",onClick:a[5]||(a[5]=d=>S(b).addSkill())},{default:n(()=>a[21]||(a[21]=[N("添加技能")])),_:1,__:[21]}),t(r,{type:"danger",onClick:a[6]||(a[6]=d=>S(b).deletePackage())},{default:n(()=>a[22]||(a[22]=[N("删除包")])),_:1,__:[22]})],64)):S(s).type==="general"?(E(),B(r,{key:2,type:"danger",onClick:a[7]||(a[7]=d=>S(b).deleteGeneral())},{default:n(()=>a[23]||(a[23]=[N("删除武将")])),_:1,__:[23]})):S(s).type==="skill"?(E(),B(r,{key:3,type:"danger",onClick:a[8]||(a[8]=d=>S(b).deleteSkill())},{default:n(()=>a[24]||(a[24]=[N("删除技能")])),_:1,__:[24]})):W("",!0),t(r,{type:"success",onClick:a[9]||(a[9]=d=>S(b).saveMod())},{default:n(()=>a[25]||(a[25]=[N("保存项目")])),_:1,__:[25]})])]),o("div",da,[S(s).type==="mod"?(E(),B(pt,{key:p("mod",S(s).value),modelValue:S(s).value,"onUpdate:modelValue":a[10]||(a[10]=d=>S(s).value=d)},null,8,["modelValue"])):S(s).type==="package"?(E(),B(ut,{key:p("package",S(s).value),modelValue:S(s).value,"onUpdate:modelValue":a[11]||(a[11]=d=>S(s).value=d)},null,8,["modelValue"])):S(s).type==="general"?(E(),B(gt,{key:p("general",S(s).value),modelValue:S(s).value,"onUpdate:modelValue":a[12]||(a[12]=d=>S(s).value=d)},null,8,["modelValue"])):S(s).type==="skill"?(E(),B(ta,{key:p("skill",S(s).value),modelValue:S(s).value,"onUpdate:modelValue":a[13]||(a[13]=d=>S(s).value=d)},null,8,["modelValue"])):W("",!0)])])],64)):(E(),U("div",la,[a[16]||(a[16]=o("img",{src:De,alt:"Logo",style:{width:"200px",height:"auto","margin-bottom":"20px"}},null,-1)),a[17]||(a[17]=o("h2",null,"欢迎使用拓展包制作器",-1)),a[18]||(a[18]=o("p",null,"请先新建或加载一个项目",-1)),t(u,null,{default:n(()=>[t(r,{type:"primary",size:"large",onClick:a[0]||(a[0]=d=>S(b).newMod())},{default:n(()=>a[14]||(a[14]=[N("新建项目")])),_:1,__:[14]}),t(r,{type:"primary",size:"large",onClick:a[1]||(a[1]=d=>S(b).loadMod())},{default:n(()=>a[15]||(a[15]=[N("加载项目")])),_:1,__:[15]})]),_:1})]))])}}},ca=X(pa,[["__scopeId","data-v-63aaecef"]]);export{ca as default};
